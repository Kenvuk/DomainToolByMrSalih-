<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Domain Insights</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
            color: #1f2937;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .title {
            font-size: 2.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #111827;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #6b7280;
            font-weight: 300;
        }

        .input-section {
            background: #f9fafb;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #e5e7eb;
        }

        .input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .domain-input {
            flex: 1;
            padding: 1rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.2s ease;
        }

        .domain-input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .analyze-btn {
            padding: 1rem 2rem;
            background-color: #111827;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .analyze-btn:hover {
            background-color: #374151;
            transform: translateY(-1px);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
            color: #6b7280;
        }

        .spinner {
            border: 2px solid #e5e7eb;
            border-top: 2px solid #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-section {
            display: none;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 2rem;
            overflow-x: auto;
        }

        .tab {
            padding: 1rem 1.5rem;
            border: none;
            background: none;
            color: #6b7280;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-family: inherit;
        }

        .tab.active {
            color: #111827;
            border-bottom-color: #111827;
        }

        .tab:hover {
            color: #374151;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(10px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            border: 1px solid #e5e7eb;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .card h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #111827;
        }

        .card p {
            color: #4b5563;
            margin-bottom: 1rem;
        }

        .card ul {
            color: #4b5563;
            padding-left: 1.5rem;
        }

        .card li {
            margin-bottom: 0.5rem;
        }

        .error-message {
            background-color: #fef2f2;
            border: 1px solid #fecaca;
            color: #b91c1c;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
        }

        .domain-display {
            font-size: 1.1rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 2rem;
            text-align: center;
        }

        @media (max-width: 640px) {
            .input-group {
                flex-direction: column;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .input-section {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Domain Insights</h1>
            <p class="subtitle">Get AI-powered analysis and insights for any domain</p>
        </div>

        <div class="input-section">
            <div class="input-group">
                <input type="text" class="domain-input" placeholder="Enter domain (e.g., example.com)" id="domainInput">
                <button class="analyze-btn" id="analyzeBtn" onclick="analyzeDomain()">Analyze Domain</button>
            </div>
            <div class="error-message" id="errorMessage"></div>
        </div>

        <div class="loading" id="loadingSection">
            <div class="spinner"></div>
            <p>Analyzing domain with AI...</p>
        </div>

        <div class="results-section" id="resultsSection">
            <div class="domain-display" id="domainDisplay"></div>
            
            <div class="tabs">
                <button class="tab active" onclick="switchTab('overview')">Overview</button>
                <button class="tab" onclick="switchTab('seo')">SEO Potential</button>
                <button class="tab" onclick="switchTab('monetization')">Monetization Ideas</button>
                <button class="tab" onclick="switchTab('value')">Estimated Value</button>
            </div>

            <div class="tab-content active" id="overview-content">
                <div class="card">
                    <h3>Domain Overview</h3>
                    <div id="overview-text"></div>
                </div>
            </div>

            <div class="tab-content" id="seo-content">
                <div class="card">
                    <h3>SEO Analysis</h3>
                    <div id="seo-text"></div>
                </div>
            </div>

            <div class="tab-content" id="monetization-content">
                <div class="card">
                    <h3>Monetization Opportunities</h3>
                    <div id="monetization-text"></div>
                </div>
            </div>

            <div class="tab-content" id="value-content">
                <div class="card">
                    <h3>Value Assessment</h3>
                    <div id="value-text"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration - Easy to swap API key
        const CONFIG = {
            GEMINI_API_KEY: 'AIzaSyBsrj-G-xnJHu5urlI-gjlL7_dnhGeBeJA',
            GEMINI_API_URL: 'https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent',
            // CORS proxy to bypass browser restrictions
            CORS_PROXY: 'https://api.allorigins.win/raw?url='
        };

        let currentResults = {};

        // Tab switching functionality
        function switchTab(tabName) {
            // Remove active class from all tabs and content
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding content
            event.target.classList.add('active');
            document.getElementById(tabName + '-content').classList.add('active');
        }

        // Domain validation
        function isValidDomain(domain) {
            const domainRegex = /^[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?\.([a-zA-Z]{2,})+$/;
            return domainRegex.test(domain);
        }

        // Clean domain input
        function cleanDomain(input) {
            return input.toLowerCase()
                       .replace(/^https?:\/\//, '')
                       .replace(/^www\./, '')
                       .replace(/\/.*$/, '')
                       .trim();
        }

        // Show error message
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        // Generate analysis prompt
        function generatePrompt(domain) {
            return `Analyze the domain "${domain}" and provide detailed insights in the following format:

OVERVIEW:
Provide a general analysis of the domain including its brandability, memorability, and market positioning potential.

SEO_POTENTIAL:
Analyze the SEO potential including keyword opportunities, search volume estimates, competition level, and ranking difficulty.

MONETIZATION:
Suggest specific monetization strategies, potential CPC ranges for related keywords, affiliate opportunities, and revenue models.

VALUE_ESTIMATE:
Provide a realistic value estimate range with justification based on comparable sales, keyword value, and market demand.

Please be specific and actionable in your recommendations. Format your response clearly with each section separated.`;
        }

        // Call Gemini API with CORS workaround
        async function callGeminiAPI(domain) {
            const prompt = generatePrompt(domain);
            
            try {
                // First try direct API call
                const directUrl = `${CONFIG.GEMINI_API_URL}?key=${CONFIG.GEMINI_API_KEY}`;
                
                const response = await fetch(directUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: prompt
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 2048,
                        }
                    })
                });

                if (!response.ok) {
                    // If direct call fails, try with CORS proxy
                    if (response.status === 0 || response.type === 'opaque') {
                        return await callWithProxy(domain, prompt);
                    }
                    throw new Error(`API request failed: ${response.status} - ${response.statusText}`);
                }

                const data = await response.json();
                
                if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
                    throw new Error('Invalid API response format');
                }

                return data.candidates[0].content.parts[0].text;
                
            } catch (error) {
                // If direct call fails due to CORS, try proxy
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    return await callWithProxy(domain, prompt);
                }
                throw error;
            }
        }

        // Fallback method using CORS proxy
        async function callWithProxy(domain, prompt) {
            const apiUrl = `${CONFIG.GEMINI_API_URL}?key=${CONFIG.GEMINI_API_KEY}`;
            const proxyUrl = CONFIG.CORS_PROXY + encodeURIComponent(apiUrl);
            
            const response = await fetch(proxyUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{
                            text: prompt
                        }]
                    }],
                    generationConfig: {
                        temperature: 0.7,
                        topK: 40,
                        topP: 0.95,
                        maxOutputTokens: 2048,
                    }
                })
            });

            if (!response.ok) {
                throw new Error(`Proxy request failed: ${response.status}`);
            }

            const data = await response.json();
            
            if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
                throw new Error('Invalid API response format');
            }

            return data.candidates[0].content.parts[0].text;
        }

        // Parse Gemini response
        function parseResponse(text) {
            const sections = {};
            const lines = text.split('\n');
            let currentSection = '';
            let currentContent = [];

            for (const line of lines) {
                if (line.includes('OVERVIEW:')) {
                    currentSection = 'overview';
                    currentContent = [];
                } else if (line.includes('SEO_POTENTIAL:')) {
                    if (currentSection) sections[currentSection] = currentContent.join('\n').trim();
                    currentSection = 'seo';
                    currentContent = [];
                } else if (line.includes('MONETIZATION:')) {
                    if (currentSection) sections[currentSection] = currentContent.join('\n').trim();
                    currentSection = 'monetization';
                    currentContent = [];
                } else if (line.includes('VALUE_ESTIMATE:')) {
                    if (currentSection) sections[currentSection] = currentContent.join('\n').trim();
                    currentSection = 'value';
                    currentContent = [];
                } else if (currentSection && line.trim()) {
                    currentContent.push(line);
                }
            }
            
            if (currentSection) {
                sections[currentSection] = currentContent.join('\n').trim();
            }

            return sections;
        }

        // Format content for display
        function formatContent(content) {
            return content.replace(/\n/g, '<br>').replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        }

        // Display results
        function displayResults(results, domain) {
            document.getElementById('domainDisplay').textContent = `Analysis for: ${domain}`;
            
            Object.keys(results).forEach(section => {
                const element = document.getElementById(`${section}-text`);
                if (element && results[section]) {
                    element.innerHTML = formatContent(results[section]);
                }
            });

            document.getElementById('resultsSection').style.display = 'block';
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }

        // Main analysis function
        async function analyzeDomain() {
            const input = document.getElementById('domainInput').value;
            const cleanedDomain = cleanDomain(input);
            
            if (!cleanedDomain) {
                showError('Please enter a domain name');
                return;
            }

            if (!isValidDomain(cleanedDomain)) {
                showError('Please enter a valid domain name (e.g., example.com)');
                return;
            }

            // Show loading state
            document.getElementById('loadingSection').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('analyzeBtn').disabled = true;
            
            try {
                const response = await callGeminiAPI(cleanedDomain);
                const results = parseResponse(response);
                
                // Store results globally
                currentResults = results;
                
                // Display results
                displayResults(results, cleanedDomain);
                
            } catch (error) {
                console.error('Analysis error:', error);
                let errorMessage = 'Failed to analyze domain. ';
                
                if (error.message.includes('fetch') || error.message.includes('CORS')) {
                    errorMessage += 'This might be due to browser security restrictions. Try hosting this app on a web server instead of opening it locally.';
                } else if (error.message.includes('API request failed: 403')) {
                    errorMessage += 'API key might be invalid or has insufficient permissions.';
                } else if (error.message.includes('API request failed: 429')) {
                    errorMessage += 'API rate limit exceeded. Please try again later.';
                } else {
                    errorMessage += 'Please check your internet connection and try again.';
                }
                
                showError(errorMessage);
            } finally {
                document.getElementById('loadingSection').style.display = 'none';
                document.getElementById('analyzeBtn').disabled = false;
            }
        }

        // Enter key support
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('domainInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    analyzeDomain();
                }
            });
        });
    </script>
</body>
</html>